# Postfix λ©”μΌ μ„λ²„ κµ¬μ„± μƒνƒ μ κ²€ λ³΄κ³ μ„

## π“§ κ°μ”
SkyBoot Mail SaaS μ‹μ¤ν…μ Postfix λ©”μΌ μ„λ²„ κµ¬μ„± μƒνƒλ¥Ό μ κ²€ν• κ²°κ³Όμ…λ‹λ‹¤.

## π”§ μ£Όμ” μ„¤μ • νλΌλ―Έν„°

### 1. Postfix Main Configuration (postfix_main.cf)

#### κΈ°λ³Έ μ„¤μ •
- **νΈμ¤νΈλ…**: localhost
- **λ„λ©”μΈ**: localhost
- **νΈν™μ„± λ λ²¨**: 3.6
- **λ°°λ„**: $myhostname ESMTP $mail_name

#### TLS/SSL λ³΄μ• μ„¤μ •
- **μΈμ¦μ„ νμΌ**: /etc/ssl/certs/ssl-cert-snakeoil.pem
- **κ°μΈν‚¤ νμΌ**: /etc/ssl/private/ssl-cert-snakeoil.key
- **SMTPD TLS λ³΄μ• λ λ²¨**: may (μ„ νƒμ )
- **SMTP TLS λ³΄μ• λ λ²¨**: encrypt (ν•„μ)
- **SASL μΈμ¦**: ν™μ„±ν™”λ¨

#### λ„¤νΈμ›ν¬ μ„¤μ •
- **μΈν„°νμ΄μ¤**: all (λ¨λ“  μΈν„°νμ΄μ¤)
- **ν”„λ΅ν† μ½**: all (IPv4, IPv6)
- **λ¦΄λ μ΄ νΈμ¤νΈ**: [smtp.gmail.com]:587
- **ν—μ© λ„¤νΈμ›ν¬**: 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128

#### κ°€μƒ λ„λ©”μΈ μ„¤μ • (SaaS λ‹¤μ¤‘ μ΅°μ§ μ§€μ›)
- **κ°€μƒ μ „μ†΅**: lmtp:unix:private/dovecot-lmtp
- **κ°€μƒ λ©”μΌλ°•μ¤ λ„λ©”μΈ**: PostgreSQL μ—°λ™
- **κ°€μƒ λ©”μΌλ°•μ¤ λ§µ**: PostgreSQL μ—°λ™
- **κ°€μƒ λ³„μΉ­ λ§µ**: PostgreSQL μ—°λ™

#### SMTP μ ν• μ •μ±…
- **HELO μ ν•**: λ„¤νΈμ›ν¬ ν—μ©, SASL μΈμ¦ ν—μ©, μλ»λ νΈμ¤νΈλ… κ±°λ¶€
- **λ°μ†΅μ μ ν•**: λ„¤νΈμ›ν¬ ν—μ©, SASL μΈμ¦ ν—μ©, FQDN κ²€μ¦
- **μμ‹ μ μ ν•**: μΈμ¦λ μ‚¬μ©μλ§ ν—μ©, μ• μ μ—†λ” λ„λ©”μΈ κ±°λ¶€

#### SASL μΈμ¦ μ„¤μ •
- **SASL νƒ€μ…**: dovecot
- **SASL κ²½λ΅**: private/auth
- **SASL μΈμ¦**: ν™μ„±ν™”λ¨
- **λ³΄μ• μµμ…**: noanonymous

### 2. Postfix Master Configuration (postfix_master.cf)

#### μ„λΉ„μ¤ ν¬νΈ μ„¤μ •
- **SMTP (25)**: ν‘μ¤€ λ©”μΌ μ „μ†΅
- **Submission (587)**: μΈμ¦λ λ©”μΌ μ μ¶
  - TLS μ•”νΈν™” ν•„μ
  - SASL μΈμ¦ ν•„μ
  - TLS μ „μ© μΈμ¦
- **SMTPS (465)**: SSL λνΌ λ¨λ“
  - TLS λνΌ λ¨λ“ ν™μ„±ν™”
  - SASL μΈμ¦ ν•„μ

#### λ‚΄λ¶€ μ„λΉ„μ¤
- **pickup**: λ΅μ»¬ λ©”μΌ μμ§‘ (60μ΄ κ°„κ²©)
- **cleanup**: λ©”μΌ μ •λ¦¬ μ„λΉ„μ¤
- **qmgr**: ν κ΄€λ¦¬μ (300μ΄ κ°„κ²©)
- **tlsmgr**: TLS κ΄€λ¦¬μ
- **rewrite**: μ£Όμ† μ¬μ‘μ„±
- **bounce**: λ°μ†΅ μ²λ¦¬

### 3. Dovecot Configuration (dovecot.conf)

#### ν”„λ΅ν† μ½ μ„¤μ •
- **μ§€μ› ν”„λ΅ν† μ½**: IMAP, POP3, LMTP
- **μμ‹  μ£Όμ†**: *, :: (λ¨λ“  μΈν„°νμ΄μ¤)

#### λ©”μΌ μ €μ¥μ† μ„¤μ •
- **λ©”μΌ μ„μΉ**: maildir:/var/mail/vhosts/%d/%n
- **λ©”μΌ μ‚¬μ©μ**: vmail (UID: 150)
- **λ©”μΌ κ·Έλ£Ή**: mail (GID: 8)

#### μΈμ¦ μ„¤μ •
- **μΈμ¦ λ©”μ»¤λ‹μ¦**: plain, login
- **ν¨μ¤μ›λ“ DB**: SQL λ“λΌμ΄λ²„ (PostgreSQL μ—°λ™)
- **μ‚¬μ©μ DB**: μ •μ  μ„¤μ •

#### μ„λΉ„μ¤ ν¬νΈ
- **IMAP**: 143 (λΉ„μ•”νΈν™”)
- **SSL**: ν„μ¬ λΉ„ν™μ„±ν™” (μ¶”ν›„ μ„¤μ • μμ •)

## β οΈ λ°κ²¬λ μ΄μ λ° κ¶μ¥μ‚¬ν•­

### 1. λ³΄μ• κ΄€λ ¨ μ΄μ
- **SSL μΈμ¦μ„**: μμ²΄ μ„λ… μΈμ¦μ„ μ‚¬μ© (snakeoil)
  - **κ¶μ¥**: μ‹ λΆ°ν•  μ μλ” CA μΈμ¦μ„λ΅ κµμ²΄
- **Dovecot SSL**: ν„μ¬ λΉ„ν™μ„±ν™” μƒνƒ
  - **κ¶μ¥**: SSL/TLS μ•”νΈν™” ν™μ„±ν™”

### 2. μ„¤μ • μµμ ν™” ν•„μ”
- **νΈμ¤νΈλ…**: localhostλ΅ μ„¤μ •λ¨
  - **κ¶μ¥**: μ‹¤μ  λ„λ©”μΈλ…μΌλ΅ λ³€κ²½
- **λ¦΄λ μ΄ νΈμ¤νΈ**: Gmail SMTP μ‚¬μ©
  - **κ¶μ¥**: ν”„λ΅λ•μ… ν™κ²½μ—μ„λ” μ „μ© SMTP μ„λ²„ μ‚¬μ©

### 3. SaaS λ‹¤μ¤‘ μ΅°μ§ μ§€μ› ν™•μΈ
- β… PostgreSQL κΈ°λ° κ°€μƒ λ„λ©”μΈ μ„¤μ • μ™„λ£
- β… κ°€μƒ λ©”μΌλ°•μ¤ λ§µ μ„¤μ • μ™„λ£
- β… μ΅°μ§λ³„ λ©”μΌ λ¶„λ¦¬ κµ¬μ΅° μ¤€λΉ„λ¨

## π“ μ„¤μ • μƒνƒ μ”μ•½

| κµ¬μ„± μ”μ† | μƒνƒ | λΉ„κ³  |
|-----------|------|------|
| Postfix SMTP | β… μ„¤μ •λ¨ | ν¬νΈ 25, 587, 465 |
| TLS μ•”νΈν™” | β οΈ λ¶€λ¶„μ  | μμ²΄ μ„λ… μΈμ¦μ„ |
| SASL μΈμ¦ | β… ν™μ„±ν™” | Dovecot μ—°λ™ |
| κ°€μƒ λ„λ©”μΈ | β… μ„¤μ •λ¨ | PostgreSQL μ—°λ™ |
| Dovecot IMAP | β… μ„¤μ •λ¨ | ν¬νΈ 143 |
| Dovecot SSL | β λΉ„ν™μ„±ν™” | λ³΄μ• κ°•ν™” ν•„μ” |
| λ‹¤μ¤‘ μ΅°μ§ μ§€μ› | β… μ¤€λΉ„λ¨ | SaaS κµ¬μ΅° μ™„λ£ |

## π”„ λ‹¤μ λ‹¨κ³„
1. SSL μΈμ¦μ„ κµμ²΄ λ° Dovecot SSL ν™μ„±ν™”
2. μ‹¤μ  λ„λ©”μΈλ…μΌλ΅ νΈμ¤νΈ μ„¤μ • λ³€κ²½
3. λ©”μΌ μ„λ²„ μ—°κ²° ν…μ¤νΈ μν–‰
4. μ΅°μ§λ³„ λ©”μΌ λ„λ©”μΈ μ„¤μ • ν…μ¤νΈ

---
*λ³΄κ³ μ„ μƒμ„± μ‹κ°„: 2024-12-29*
*μ κ²€ λ€μƒ: SkyBoot Mail SaaS Postfix μ„¤μ •*