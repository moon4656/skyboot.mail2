# 📋 Mail Convenience Router 테스트 체크리스트

## 🎯 테스트 개요
- **대상 파일**: `backend/app/router/mail_convenience_router.py`
- **테스트 일시**: 2024년 12월 30일
- **테스트 환경**: Windows + WSL (Postfix)
- **데이터베이스**: PostgreSQL (SaaS 다중 조직 지원)

## 📊 테스트 진행 상황

### ✅ 1. 환경 설정 및 준비 작업
- [ ] 데이터베이스 연결 확인
- [ ] 테스트 사용자 및 조직 생성
- [ ] JWT 토큰 발급 확인
- [ ] 테스트 메일 데이터 준비

### 🔍 2. 메일 검색 엔드포인트 (`POST /search`)
- [ ] **기본 검색 기능**
  - [ ] 빈 검색어로 전체 메일 조회
  - [ ] 제목 키워드 검색
  - [ ] 본문 내용 검색
  - [ ] 페이지네이션 동작 확인
- [ ] **고급 검색 기능**
  - [ ] 발신자 이메일 필터링
  - [ ] 수신자 이메일 필터링
  - [ ] 날짜 범위 필터링 (date_from, date_to)
  - [ ] 메일 상태 필터링 (SENT, DRAFT, etc.)
  - [ ] 우선순위 필터링 (HIGH, MEDIUM, LOW)
- [ ] **조직별 분리 확인**
  - [ ] 다른 조직의 메일이 검색되지 않는지 확인
  - [ ] 현재 조직의 메일만 검색되는지 확인
- [ ] **에러 처리**
  - [ ] 잘못된 날짜 형식 처리
  - [ ] 존재하지 않는 사용자 검색 처리
  - [ ] 권한 없는 접근 처리

**테스트 결과**:
```
[ ] PASS / [ ] FAIL
오류 내용: 
수정 사항: 
```

### 📈 3. 메일 통계 엔드포인트 (`GET /stats`)
- [ ] **기본 통계 조회**
  - [ ] 총 보낸 메일 수 (total_sent)
  - [ ] 총 받은 메일 수 (total_received)
  - [ ] 임시보관함 메일 수 (total_drafts)
  - [ ] 읽지 않은 메일 수 (unread_count)
- [ ] **일별 통계**
  - [ ] 오늘 보낸 메일 수 (today_sent)
  - [ ] 오늘 받은 메일 수 (today_received)
- [ ] **조직별 분리 확인**
  - [ ] 다른 조직의 통계가 포함되지 않는지 확인
  - [ ] 현재 조직의 통계만 반환되는지 확인
- [ ] **폴더별 통계**
  - [ ] 받은편지함 메일 수 정확성
  - [ ] 휴지통 메일 수 정확성

**테스트 결과**:
```
[ ] PASS / [ ] FAIL
오류 내용: 
수정 사항: 
```

### 📬 4. 읽지 않은 메일 조회 엔드포인트 (`GET /unread`)
- [ ] **기본 기능**
  - [ ] 읽지 않은 메일만 조회되는지 확인
  - [ ] 페이지네이션 동작 확인
  - [ ] 최신순 정렬 확인
- [ ] **데이터 정확성**
  - [ ] 발신자 정보 정확성
  - [ ] 수신자 정보 정확성
  - [ ] 첨부파일 개수 정확성
  - [ ] 읽음 상태 정확성 (현재 기본값 false)
- [ ] **조직별 분리**
  - [ ] 현재 조직의 받은편지함만 조회
  - [ ] 다른 조직의 메일 제외 확인
- [ ] **에러 처리**
  - [ ] 받은편지함이 없는 경우 처리
  - [ ] 빈 결과 처리

**테스트 결과**:
```
[ ] PASS / [ ] FAIL
오류 내용: 
수정 사항: 
```

### ⭐ 5. 중요 표시된 메일 조회 엔드포인트 (`GET /starred`)
- [ ] **기본 기능**
  - [ ] 우선순위 HIGH 메일만 조회
  - [ ] 페이지네이션 동작 확인
  - [ ] 최신순 정렬 확인
- [ ] **데이터 정확성**
  - [ ] 발신자/수신자 정보 정확성
  - [ ] 우선순위 필터링 정확성
  - [ ] 첨부파일 정보 정확성
- [ ] **조직별 분리**
  - [ ] 현재 조직의 메일만 조회
  - [ ] 보낸/받은 메일 모두 포함 확인
- [ ] **에러 처리**
  - [ ] 중요 메일이 없는 경우 처리
  - [ ] 빈 결과 처리

**테스트 결과**:
```
[ ] PASS / [ ] FAIL
오류 내용: 
수정 사항: 
```

## 🔧 공통 테스트 항목

### 🔐 인증 및 권한
- [ ] JWT 토큰 검증 동작
- [ ] 만료된 토큰 처리
- [ ] 잘못된 토큰 처리
- [ ] 권한 없는 접근 차단

### 🏢 다중 조직 지원 (SaaS)
- [ ] 조직 ID 필터링 정확성
- [ ] 조직간 데이터 격리 확인
- [ ] 테넌트 미들웨어 동작 확인

### 📝 로깅 및 모니터링
- [ ] 구조화된 로그 출력 확인
- [ ] 조직 ID 및 사용자 정보 포함
- [ ] 에러 로그 상세 정보 확인
- [ ] 성능 메트릭 로깅

### 🚀 성능 및 최적화
- [ ] 쿼리 성능 확인
- [ ] 페이지네이션 성능
- [ ] 대용량 데이터 처리
- [ ] 메모리 사용량 확인

## 📋 최종 테스트 요약

### ✅ 성공한 테스트
```
총 테스트 항목: ___개
성공: ___개
실패: ___개
성공률: ___%
```

### ❌ 실패한 테스트 및 수정 사항
```
1. [엔드포인트명] - [실패 원인]
   수정 사항: 
   재테스트 결과: 

2. [엔드포인트명] - [실패 원인]
   수정 사항: 
   재테스트 결과: 
```

### 🔄 추가 개선 사항
```
1. 읽음 상태 추적 기능 구현 필요
2. 성능 최적화 방안
3. 추가 보안 강화 방안
4. 사용자 경험 개선 방안
```

## 📊 테스트 완료 확인

- [ ] 모든 엔드포인트 테스트 완료
- [ ] 오류 수정 및 재테스트 완료
- [ ] 성능 테스트 완료
- [ ] 보안 테스트 완료
- [ ] 문서화 완료

**최종 승인**: [ ] 테스트 완료 및 프로덕션 배포 준비 완료

---
**테스트 담당자**: AI Assistant  
**검토자**: 사용자  
**완료 일시**: ___________